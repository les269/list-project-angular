<div class="d-flex justify-content-between align-items-center">
  <h2 mat-dialog-title>
    {{ 'shareTag.tagValueList' | translate }}ï¼š{{ data.shareTagName }}
  </h2>
  <button class="d-flex mx-2" mat-icon-button (click)="onClose()">
    <mat-icon>close</mat-icon>
  </button>
</div>
<mat-dialog-content class="scrollbar-primary overflow-y-hidden">
  <div class="share-tag-vlaue-list">
    <div class="toolbar d-flex justify-content-between align-items-center mb-2">
      <div class="filter-box" style="flex: 1; max-width: 420px">
        <input
          class="form-control"
          [placeholder]="'g.filter' | translate"
          (input)="applyFilter($event)" />
      </div>
      <div class="ms-2">
        <button
          type="button"
          class="btn add mx-2"
          (click)="openAddValueDialog()">
          {{ 'g.add' | translate }}
        </button>
        <button
          type="button"
          class="btn add"
          (click)="onDeleteSelect()"
          [disabled]="selection.isEmpty()">
          {{ 'g.deleteSelected' | translate }}
        </button>
      </div>
    </div>
    <div class="dialog">
      <div class="table-container">
        <table
          mat-table
          [dataSource]="dataSource"
          multiTemplateDataRows
          matSort>
          <!-- Checkbox Column -->
          <ng-container matColumnDef="select">
            <th mat-header-cell *matHeaderCellDef>
              <mat-checkbox
                (change)="$event ? toggleAllRows() : null"
                [checked]="selection.hasValue() && isAllSelected()"
                [indeterminate]="selection.hasValue() && !isAllSelected()">
              </mat-checkbox>
            </th>
            <td mat-cell *matCellDef="let tagValue">
              <mat-checkbox
                (click)="$event.stopPropagation()"
                (change)="$event ? selection.toggle(tagValue) : null"
                [checked]="selection.isSelected(tagValue)">
              </mat-checkbox>
            </td>
          </ng-container>
          <!-- value Column -->
          <ng-container matColumnDef="value">
            <th
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header
              class="sticky-header"
              [ngStyle]="{ width: '400px' }">
              {{ 'shareTag.tagValue' | translate }}
            </th>
            <td mat-cell *matCellDef="let tagValue">
              {{ tagValue.value }}
            </td>
          </ng-container>

          <!-- Updated Time -->
          <ng-container matColumnDef="updatedTime">
            <th
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header
              class="sticky-header"
              [ngStyle]="{ width: '200px' }">
              {{ 'g.updatedTime' | translate }}
            </th>
            <td mat-cell *matCellDef="let tagValue">
              {{ tagValue.updatedTime | date: 'yyyy-MM-dd HH:mm' }}
            </td>
          </ng-container>

          <!-- Actions -->
          <ng-container matColumnDef="action">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="sticky-header"
              [ngStyle]="{ width: '100px' }"></th>
            <td mat-cell *matCellDef="let tagValue">
              <div class="d-flex">
                <button mat-icon-button (click)="deleteTag(tagValue.value)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </div>
      @if (!dataSource.data || dataSource.data.length === 0) {
        <div class="empty mt-2">
          {{ 'shareTag.noTagValue' | translate }}
        </div>
      }
    </div>
  </div>
</mat-dialog-content>

<!-- Add dialog template (opened by MatDialog) -->
<ng-template #addTagValueDialog>
  <h2 mat-dialog-title>{{ 'shareTag.addTagValue' | translate }}</h2>
  <mat-dialog-content>
    <div class="mb-3">
      <label for="tagValue" class="form-label">{{
        'shareTag.tagValue' | translate
      }}</label>
      <input type="text" class="form-control" [(ngModel)]="newValue" />
    </div>
  </mat-dialog-content>
  <mat-dialog-actions>
    <button
      type="button"
      class="btn btn-secondary"
      (click)="closeAddValueDialog()">
      {{ 'g.no' | translate }}
    </button>
    <button
      type="button"
      class="btn btn-primary"
      (click)="confirmAddValueTag()">
      {{ 'g.ok' | translate }}
    </button>
  </mat-dialog-actions>
</ng-template>
